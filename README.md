# CUIS - Cosyma Unified Info-System

Модульная система для управления устройствами, клиентами и сервисными заявками.

## Структура проекта

Монорепозиторий с модульной архитектурой:

```
/
├── packages/                # Переиспользуемые пакеты (библиотеки)
│   ├── domain/              # Доменные модели и интерфейсы (бизнес-сущности)
│   ├── persistence/         # Реализация доступа к данным (репозитории)
│   ├── use-cases/           # Бизнес-логика и сценарии использования (сервисы)
│   ├── api/                 # API контроллеры и DTO (интерфейс)
│   └── frontend/            # React-приложение для пользовательского интерфейса
│
├── apps/                    # Запускаемые приложения
│   └── api-server/          # REST API сервер (использует пакеты)
│
└── Flower Form/             # Интегрированный проект форм оценки пациентов
```

### Пояснение структуры:

1. **packages/** - содержит переиспользуемые библиотеки, которые можно публиковать отдельно:
   - **domain/** - чистые доменные модели без зависимостей от фреймворков
   - **persistence/** - реализации репозиториев для работы с БД
   - **use-cases/** - бизнес-логика, использующая domain
   - **api/** - контроллеры и DTO для REST API
   - **frontend/** - React-приложение для пользовательского интерфейса

2. **apps/** - содержит запускаемые приложения, которые используют пакеты:
   - **api-server/** - основной REST API сервер

3. **Flower Form/** - интегрированный проект форм оценки пациентов:
   - Содержит формы ЛФК и FIM для оценки пациентов
   - Интегрирован с основным проектом через iframe

## Технологии

- **Node.js** - среда выполнения
- **TypeScript** - язык программирования
- **NestJS** - фреймворк для API
- **PostgreSQL** - база данных
- **Knex.js** - SQL builder
- **Turborepo** - инструмент для монорепозитория

## Запуск проекта

### Установка зависимостей

```bash
npm install
```

### Запуск API сервера в режиме разработки

```bash
npm run api:dev
```

### Сборка проекта

```bash
npm run build
```

### Запуск API сервера в production режиме

```bash
npm run api:build
npm run api:start
```

## Архитектура

Проект построен на принципах чистой архитектуры и DDD:

1. **Domain** - содержит бизнес-модели и интерфейсы портов
2. **Persistence** - реализует доступ к данным через адаптеры
3. **Use Cases** - содержит сценарии использования и бизнес-логику
4. **API** - предоставляет REST API интерфейс
5. **Frontend** - пользовательский интерфейс на React

## Интеграция Flower Form

Проект Flower Form интегрирован в основное приложение и предоставляет следующие возможности:

- Формы оценки пациентов (ЛФК и FIM)
- Хранение данных форм в основной базе данных
- Просмотр истории заполнений форм
- Интеграция с карточками пациентов

Подробная документация по интеграции доступна в файле [docs/flower-form-integration.md](docs/flower-form-integration.md).
