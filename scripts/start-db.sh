#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะทะฐะฟััะบะฐ ัะพะปัะบะพ ะฑะฐะทั ะดะฐะฝะฝัั ะธ Adminer
set -e

echo "๐ ะะฐะฟััะบ ะฑะฐะทั ะดะฐะฝะฝัั..."

# ะะฐะฟััะบ Docker ะบะพะฝัะตะนะฝะตัะพะฒ
echo "๐ณ ะะฐะฟััะบ PostgreSQL ะธ Adminer..."
docker-compose up -d

# ะะถะธะดะฐะฝะธะต ะณะพัะพะฒะฝะพััะธ ะฑะฐะทั ะดะฐะฝะฝัั
echo "โณ ะะถะธะดะฐะฝะธะต ะณะพัะพะฒะฝะพััะธ ะฑะฐะทั ะดะฐะฝะฝัั..."
sleep 5

# ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั
if docker-compose exec -T db pg_isready -U reki > /dev/null 2>&1; then
    echo "โ ะะฐะทะฐ ะดะฐะฝะฝัั ะทะฐะฟััะตะฝะฐ ะธ ะณะพัะพะฒะฐ ะบ ัะฐะฑะพัะต!"
    echo "๐๏ธ  PostgreSQL: localhost:5432"
    echo "๐ Adminer: http://localhost:8080"
else
    echo "โ ะัะธะฑะบะฐ ะฟัะธ ะทะฐะฟััะบะต ะฑะฐะทั ะดะฐะฝะฝัั"
    exit 1
fi
